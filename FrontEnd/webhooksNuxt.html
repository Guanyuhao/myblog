<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webhooks-nuxt | Guanyuhao</title>
    <meta name="description" content="å‰ç«¯">
    <link rel="icon" href="/myblog/yuhao.jpg">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.84cc7206.css" as="style"><link rel="preload" href="/myblog/assets/js/app.8fae4f1c.js" as="script"><link rel="preload" href="/myblog/assets/js/2.b3a321be.js" as="script"><link rel="preload" href="/myblog/assets/js/8.00ec649f.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.52097b13.js"><link rel="prefetch" href="/myblog/assets/js/11.096a13cf.js"><link rel="prefetch" href="/myblog/assets/js/12.f726468c.js"><link rel="prefetch" href="/myblog/assets/js/13.b464e7ce.js"><link rel="prefetch" href="/myblog/assets/js/14.e155bae5.js"><link rel="prefetch" href="/myblog/assets/js/15.3681efce.js"><link rel="prefetch" href="/myblog/assets/js/16.ebbcc551.js"><link rel="prefetch" href="/myblog/assets/js/17.c9a51060.js"><link rel="prefetch" href="/myblog/assets/js/3.e4b83972.js"><link rel="prefetch" href="/myblog/assets/js/4.05180909.js"><link rel="prefetch" href="/myblog/assets/js/5.f666addd.js"><link rel="prefetch" href="/myblog/assets/js/6.6e612b81.js"><link rel="prefetch" href="/myblog/assets/js/7.249bd6b5.js"><link rel="prefetch" href="/myblog/assets/js/9.78e190c6.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.84cc7206.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><!----> <span class="site-name">Guanyuhao</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/algorithm/" class="nav-link">å‰ç«¯ç®—æ³•</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/guanyuhao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHubåœ°å€
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/myblog/algorithm/" class="nav-link">å‰ç«¯ç®—æ³•</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/guanyuhao" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHubåœ°å€
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å‰ç«¯</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/FrontEnd/" class="sidebar-link">ä»‹ç»</a></li><li><a href="/myblog/FrontEnd/webhooksNuxt.html" class="active sidebar-link">webhooks-nuxt</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/FrontEnd/webhooksNuxt.html#ä¸€ã€ä½¿ç”¨-create-nuxt-app-è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®" class="sidebar-link">ä¸€ã€ä½¿ç”¨ create-nuxt-app è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®</a></li><li class="sidebar-sub-header"><a href="/myblog/FrontEnd/webhooksNuxt.html#äºŒã€ä¿®æ”¹-package-json-ä¸­çš„-npm-scripts" class="sidebar-link">äºŒã€ä¿®æ”¹ package.json ä¸­çš„ npm scripts</a></li><li class="sidebar-sub-header"><a href="/myblog/FrontEnd/webhooksNuxt.html#ä¸‰ã€æ·»åŠ -webhooks-æ¥å£" class="sidebar-link">ä¸‰ã€æ·»åŠ  Webhooks æ¥å£</a></li><li class="sidebar-sub-header"><a href="/myblog/FrontEnd/webhooksNuxt.html#å››ã€å¦‚ä½•æ— ç¼æ›´æ–°æœåŠ¡" class="sidebar-link">å››ã€å¦‚ä½•æ— ç¼æ›´æ–°æœåŠ¡</a></li><li class="sidebar-sub-header"><a href="/myblog/FrontEnd/webhooksNuxt.html#äº”ã€éƒ¨ç½²å…¬é’¥ç®¡ç†" class="sidebar-link">äº”ã€éƒ¨ç½²å…¬é’¥ç®¡ç†</a></li><li class="sidebar-sub-header"><a href="/myblog/FrontEnd/webhooksNuxt.html#å…­ã€docker-éƒ¨ç½²" class="sidebar-link">å…­ã€Docker éƒ¨ç½²</a></li><li class="sidebar-sub-header"><a href="/myblog/FrontEnd/webhooksNuxt.html#ä¸ƒã€ç•™ä¸ªåé—¨" class="sidebar-link">ä¸ƒã€ç•™ä¸ªåé—¨</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webhooks-nuxt"><a href="#webhooks-nuxt" class="header-anchor">#</a> webhooks-nuxt</h1> <blockquote><p>å€ŸåŠ© Webhooks å®ç° Vue SSR é¡¹ç›®çš„è‡ªåŠ¨åŒ–éƒ¨ç½²</p></blockquote> <blockquote><p>åŸæ–‡ https://github.com/HaoChuan9421/webhooks-nuxt-demo</p></blockquote> <h2 id="ä¸€ã€ä½¿ç”¨-create-nuxt-app-è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®"><a href="#ä¸€ã€ä½¿ç”¨-create-nuxt-app-è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®" class="header-anchor">#</a> ä¸€ã€ä½¿ç”¨ <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer">create-nuxt-app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®</h2> <p>åˆ›å»ºæ—¶çš„å„ç§é€‰é¡¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±é¡¹ç›®çš„å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ï¼Œä½† <code>server framework</code> è¯·é€‰æ‹© <code>express</code>ï¼Œæœ¬æ–‡ä¹Ÿå°†ä»¥ <code>express</code> ä½œä¸ºæœåŠ¡ç«¯æ¡†æ¶å±•å¼€ä»‹ç»ã€‚</p> <h2 id="äºŒã€ä¿®æ”¹-package-json-ä¸­çš„-npm-scripts"><a href="#äºŒã€ä¿®æ”¹-package-json-ä¸­çš„-npm-scripts" class="header-anchor">#</a> äºŒã€ä¿®æ”¹ package.json ä¸­çš„ npm scripts</h2> <p><code>Nuxt</code> è„šæ‰‹æ¶ç”Ÿæˆçš„é¡¹ç›®ï¼Œé»˜è®¤åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹éœ€è¦å…ˆæ‰§è¡Œ <code>npm run build</code> æ„å»ºä»£ç ï¼Œç„¶åå†æ‰§è¡Œ <code>npm start</code> å¯åŠ¨æœåŠ¡ï¼Œè¿™ç•¥æ˜¾ç¹çï¼Œä¹Ÿä¸åˆ©äºè‡ªåŠ¨éƒ¨ç½²ã€é‡æ–°æ„å»ºç­‰å·¥ä½œçš„å±•å¼€ï¼Œè¿™é‡Œå°†ä¸¤è€…çš„åŠŸèƒ½åˆäºŒä¸ºä¸€ï¼Œæ‰§è¡Œ <code>npm start</code>ï¼Œå³å¯åœ¨<a href="https://zh.nuxtjs.org/api/nuxt" target="_blank" rel="noopener noreferrer">ç¼–ç ä¸­ä½¿ç”¨æ„å»º<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>å¹¶å¯åŠ¨æœåŠ¡ã€‚å¾—ç›Šäº <code>Nuxt</code> é…ç½®ä¸­çš„ <a href="https://zh.nuxtjs.org/api/configuration-dev" target="_blank" rel="noopener noreferrer">dev å‚æ•°<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, åœ¨ä¸åŒçš„ç¯å¢ƒä¸‹ï¼ˆ<code>NODE_ENV</code>ï¼‰ï¼Œå³ä½¿ä½¿ç”¨çš„éƒ½æ˜¯ <code>new Builder(nuxt).build()</code> æ¥è¿›è¡Œæ„å»ºï¼Œä½†ç”±äº <code>dev</code> å‚æ•°çš„ä¸åŒï¼Œ<code>Nuxt</code> çš„æ„å»ºè¡Œä¸ºä¹Ÿä¼šç›¸åº”çš„ä¸åŒå¹¶è¿›è¡Œé’ˆå¯¹æ€§çš„ä¼˜åŒ–ã€‚è¿™é‡Œç”Ÿäº§ç¯å¢ƒï¼ˆ<code>production</code>ï¼‰ä¸‹å¯åŠ¨æœåŠ¡ä¹Ÿä¸å†æ˜¯é€šè¿‡ <code>node</code> å‘½ä»¤è€Œæ˜¯ä½¿ç”¨ <a href="https://www.npmjs.com/package/nodemon" target="_blank" rel="noopener noreferrer">nodemon<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå®ƒç”¨äºç›‘å¬ <code>server/index.js</code> æ–‡ä»¶çš„å˜åŒ–ï¼Œåœ¨ <code>server/index.js</code> æ›´æ–°æ—¶å¯ä»¥è‡ªåŠ¨é‡å¯æœåŠ¡ã€‚è°ƒæ•´å‰åçš„ <code>npm scripts</code> å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å‰</span>
<span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;dev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;cross-env NODE_ENV=development nodemon server/index.js --watch server&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;build&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;nuxt build&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;start&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;cross-env NODE_ENV=production node server/index.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å</span>
<span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;dev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;cross-env NODE_ENV=development nodemon server/index.js --watch server&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;start&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;cross-env NODE_ENV=production nodemon server/index.js --watch server&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åŒæ—¶ï¼Œåˆ é™¤ <code>server/index.js</code> ä¸­åŸæœ¬çš„æ¡ä»¶åˆ¤æ–­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//if (config.dev) {</span>
<span class="token keyword">const</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span>nuxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//}</span>
</code></pre></div><p>è°ƒæ•´ä¹‹åï¼Œæ‰§è¡Œ <code>npm run dev</code>ï¼Œå°±ä¼šåœ¨ 3000 ç«¯å£å¯åŠ¨ä¸€ä¸ªæœ‰ä»£ç çƒ­æ›¿æ¢ï¼ˆ<code>HMR</code>ï¼‰ç­‰åŠŸèƒ½çš„ä¸€ä¸ªå¼€å‘ï¼ˆ<code>development</code>ï¼‰æœåŠ¡ï¼Œè€Œæ‰§è¡Œ <code>npm start</code> å°±ä¼šæ„å»ºå‡ºå‹ç¼©åçš„ä»£ç ï¼Œå¹¶å¯åŠ¨ä¸€ä¸ªå¸¦ <code>gzip</code> å‹ç¼©ç­‰åŠŸèƒ½çš„ç”Ÿäº§ï¼ˆ<code>production</code>ï¼‰æœåŠ¡ã€‚</p> <h2 id="ä¸‰ã€æ·»åŠ -webhooks-æ¥å£"><a href="#ä¸‰ã€æ·»åŠ -webhooks-æ¥å£" class="header-anchor">#</a> ä¸‰ã€æ·»åŠ  Webhooks æ¥å£</h2> <p><code>Webhooks</code> æ˜¯ä»€ä¹ˆï¼Ÿç®€å•æ¥è¯´ï¼šå‡å¦‚ä½ å‘ä¸€ä¸ªä»“åº“æ·»åŠ äº† <code>Webhook</code> ï¼Œé‚£ä¹ˆå½“ä½  <code>push</code> ä»£ç æ—¶ï¼Œ<code>git</code> æœåŠ¡å™¨å°±ä¼šè‡ªåŠ¨å‘ä½ æŒ‡å®šçš„åœ°å€ï¼Œå‘é€ä¸€ä¸ªå¸¦æœ‰æ›´æ–°ä¿¡æ¯ï¼ˆ<code>payload</code>ï¼‰çš„ <code>post</code> è¯·æ±‚ã€‚äº†è§£æ›´å¤šï¼Œè¯·é˜…è¯» <a href="https://developer.github.com/webhooks/" target="_blank" rel="noopener noreferrer">GitHub å…³äº Webhooks çš„ä»‹ç»æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æˆ–è€… <a href="https://gitee.com/help/categories/40" target="_blank" rel="noopener noreferrer">ç äº‘çš„æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚ç”±äºæˆ‘ä»¬ä½¿ç”¨äº† <code>express</code> æ¥åˆ›å»º <code>http</code> æœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·æ–¹ä¾¿çš„æ·»åŠ ä¸€ä¸ªæ¥å£ï¼Œç”¨äºæ¥æ”¶æ¥è‡ª <code>git</code> æœåŠ¡å™¨çš„ <code>post</code> è¯·æ±‚ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token comment">// è®¢é˜…æ¥è‡ª git æœåŠ¡å™¨ çš„ Webhooks è¯·æ±‚ï¼ˆpost ç±»å‹ï¼‰</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/webhooks'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä½¿ç”¨ secret token å¯¹è¯¥ API çš„è°ƒç”¨è¿›è¡Œé‰´æƒ, è¯¦ç»†æ–‡æ¡£: https://developer.github.com/webhooks/securing/</span>
  <span class="token keyword">const</span> <span class="token constant">SECRET_TOKEN</span> <span class="token operator">=</span> <span class="token string">'b65c19b95906e027c5d8'</span><span class="token punctuation">;</span>
  <span class="token comment">// è®¡ç®—ç­¾å</span>
  <span class="token keyword">const</span> signature <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">sha1=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>crypto
    <span class="token punctuation">.</span><span class="token function">createHmac</span><span class="token punctuation">(</span><span class="token string">'sha1'</span><span class="token punctuation">,</span> <span class="token constant">SECRET_TOKEN</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token comment">// éªŒè¯ç­¾åå’Œ Webhooks è¯·æ±‚ä¸­çš„ç­¾åæ˜¯å¦ä¸€è‡´</span>
  <span class="token keyword">const</span> isValid <span class="token operator">=</span> signature <span class="token operator">===</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'x-hub-signature'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// å¦‚æœéªŒè¯é€šè¿‡ï¼Œè¿”å›æˆåŠŸçŠ¶æ€å¹¶æ›´æ–°æœåŠ¡</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isValid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Authorized'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">upgrade</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// é‰´æƒå¤±è´¥ï¼Œè¿”å›æ— æƒé™æç¤º</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Permission Denied'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
</code></pre></div><p>è¿™é‡Œçš„ <code>app</code> æ˜¯ä¸€ä¸ª <code>express</code> åº”ç”¨ï¼Œæˆ‘ä»¬é€šè¿‡äº† <code>Node</code> çš„ <code>crypto</code> æ¨¡å—è®¡ç®—ç­¾åå¹¶å’Œ <code>Webhooks</code> è¯·æ±‚ä¸­çš„ç­¾åæ¯”å¯¹æ¥è¿›è¡Œé‰´æƒï¼Œä»¥ä¿è¯æ¥å£è°ƒç”¨çš„å®‰å…¨æ€§ï¼ˆè¿™é‡Œçš„èƒ½å¤Ÿè·å–åˆ° <code>Webhooks</code> è¯·æ±‚çš„è¯·æ±‚ä½“ â€”â€” <code>req.body</code> æ˜¯ç”±äºä½¿ç”¨äº† <a href="https://www.npmjs.com/package/body-parser" target="_blank" rel="noopener noreferrer">body-parser ä¸­é—´ä»¶<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼‰ã€‚å¦‚æœé‰´æƒé€šè¿‡åˆ™è¿”å›æˆåŠŸçŠ¶æ€ï¼Œå¹¶æ‰§è¡Œ <code>upgrade</code> å‡½æ•°æ¥æ›´æ–°æœåŠ¡ï¼Œå¦‚æœé‰´æƒå¤±è´¥ï¼Œåˆ™è¿”å›æ— æƒé™æç¤ºã€‚åŒæ—¶ï¼Œä½ éœ€è¦å‘ä»“åº“æ·»åŠ  <code>Webhook</code>ï¼Œå¦‚ä¸‹å›¾ï¼š</p> <img src="https://github.com/HaoChuan9421/webhooks-nuxt-demo/blob/master/assets/add_webhooks.png" style="width:100%;"> <h2 id="å››ã€å¦‚ä½•æ— ç¼æ›´æ–°æœåŠ¡"><a href="#å››ã€å¦‚ä½•æ— ç¼æ›´æ–°æœåŠ¡" class="header-anchor">#</a> å››ã€å¦‚ä½•æ— ç¼æ›´æ–°æœåŠ¡</h2> <p>å¦‚æœä½ çš„é¡¹ç›®å·²ç»åœ¨ <code>http://www.example.com/</code> ä¸‹å¯åŠ¨æˆåŠŸï¼Œé‚£ä¹ˆå½“ä½ æ¯æ¬¡å‘ <code>GitHub</code> ä»“åº“ <code>push</code> ä»£ç æ—¶ï¼Œä½ çš„æ¥å£éƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªæ¥è‡ª <code>GitHub</code> çš„ <code>post</code> è¯·æ±‚ï¼Œå¹¶åœ¨é‰´æƒé€šè¿‡åæ‰§è¡Œ <code>upgrade</code> å‡½æ•°æ¥æ›´æ–°æœåŠ¡ã€‚å…³äºå¦‚ä½•åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨é¡¹ç›®æˆ‘ä»¬æŒ‰ä¸‹ä¸è¡¨ï¼Œå…ˆä»‹ç» <code>upgrade</code> å‡½æ•°éƒ½åšäº†ä»€ä¹ˆã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * ä» git æœåŠ¡å™¨æ‹‰å–æœ€æ–°ä»£ç ï¼Œæ›´æ–° npm ä¾èµ–ï¼Œå¹¶é‡æ–°æ„å»ºé¡¹ç›®
 */</span>
<span class="token keyword">function</span> <span class="token function">upgrade</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">&quot;git pull -f &amp;&amp; npm install&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>execCommand</code> å‡½æ•°å¦‚ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº† <code>Node</code> çš„ <a href="https://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback" target="_blank" rel="noopener noreferrer">child_process<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ¨¡å—ï¼Œç”¨ä»¥åˆ›å»ºå­è¿›ç¨‹ï¼Œæ¥æ‰§è¡Œæ‹‰å–ä»£ç ï¼Œ æ›´æ–° <code>npm</code> ä¾èµ–ç­‰å‘½ä»¤ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> execSync <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;child_process&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * åˆ›å»ºå­è¿›ç¨‹ï¼Œæ‰§è¡Œå‘½ä»¤
 * @param {String} command éœ€è¦æ‰§è¡Œçš„å‘½ä»¤
 * @param {Boolean} reBuild æ˜¯å¦é‡æ–°æ„å»ºåº”ç”¨
 * @param {Function} callback æ‰§è¡Œå‘½ä»¤åçš„å›è°ƒ
 */</span>
<span class="token keyword">function</span> <span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token parameter">command<span class="token punctuation">,</span> reBuild<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  command <span class="token operator">&amp;&amp;</span> <span class="token function">execSync</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token punctuation">{</span> stdio<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ ¹æ®é…ç½®æ–‡ä»¶ï¼Œé‡æ–°æ„å»ºé¡¹ç›®</span>
  reBuild <span class="token operator">&amp;&amp;</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>build</code> å‡½æ•°ï¼Œä¼šæ ¹æ®é…ç½®æ–‡ä»¶ï¼Œé‡æ–°æ„å»ºé¡¹ç›®ï¼Œè¿™é‡Œçš„ <code>upgrading</code> æ˜¯ä¸€ä¸ªæ ‡è®°åº”ç”¨æ˜¯å¦æ­£åœ¨å‡çº§çš„ <code>flag</code>ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * æ ¹æ®é…ç½®ï¼Œæ„å»ºé¡¹ç›®
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>upgrading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  upgrading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">// å¯¼å…¥ Nuxt.js å‚æ•°</span>
  <span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../nuxt.config.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ ¹æ®ç¯å¢ƒå˜é‡ NODE_ENVï¼Œè®¾ç½® config.dev çš„å€¼</span>
  config<span class="token punctuation">.</span>dev <span class="token operator">=</span> <span class="token operator">!</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// åˆå§‹åŒ– Nuxt.js</span>
  <span class="token keyword">const</span> nuxt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Nuxt</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ„å»ºåº”ç”¨ï¼Œå¾—ç›Šäºç¯å¢ƒå˜é‡ NODE_ENVï¼Œåœ¨å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒä¸‹è¿™ä¸ªæ„å»ºçš„è¡¨ç°ä¼šä¸åŒ</span>
  <span class="token keyword">const</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Builder</span><span class="token punctuation">(</span>nuxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ç­‰å¾…æ„å»º</span>
  <span class="token keyword">await</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ„å»ºå®Œæˆåï¼Œæ›´æ–° render ä¸­é—´ä»¶</span>
  render <span class="token operator">=</span> nuxt<span class="token punctuation">.</span>render<span class="token punctuation">;</span>
  <span class="token comment">// å°† flag ç½®å</span>
  upgrading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token comment">// å¦‚æœæ˜¯åˆæ¬¡æ„å»ºï¼Œåˆ™åˆ›å»º http server</span>
  server <span class="token operator">||</span> <span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>createServer</code> å‡½æ•°å¦‚ä¸‹ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œ<code>render</code> å’Œ <code>server</code>ï¼Œå…¶ä¸­ <code>render</code> å˜é‡ä¿å­˜äº†æœ€æ–°æ„å»ºåçš„ <code>nuxt.render</code> ä¸­é—´ä»¶ï¼Œè€Œ <code>server</code> å˜é‡æ˜¯åº”ç”¨çš„ <code>http server</code> å®ä¾‹ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * åˆ›å»ºåº”ç”¨çš„ http server
 */</span>
<span class="token keyword">function</span> <span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å‘ express åº”ç”¨æ·»åŠ  nuxt ä¸­é—´ä»¶ï¼Œé‡æ–°æ„å»ºä¹‹åï¼Œä¸­é—´ä»¶ä¼šå‘ç”Ÿå˜åŒ–</span>
  <span class="token comment">// è¿™ç§å¤„ç†æ–¹å¼çš„å¥½å¤„å°±åœ¨äº express ä½¿ç”¨çš„æ€»æ˜¯æœ€æ–°çš„ nuxt.render</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å¯åŠ¨æœåŠ¡</span>
  server <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    consola<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      message<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Server listening on http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      badge<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è®¿é—®<a href="http://gitlab.corp.elensdata.com/guancong/llpssr/server/index.js" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼ŒæŸ¥çœ‹å®Œæ•´çš„ <code>server/index.js</code> æ–‡ä»¶ã€‚ä½†è¿™é‡Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ â˜ï¸ï¼Œå°±æ˜¯æ¯æ¬¡æ‰§è¡Œ <code>build</code> å‡½æ•°ï¼Œé‡æ–°æ„å»ºæ—¶ï¼Œç”±äº <code>Nuxt</code> ä¼šåˆ é™¤ä¸Šä¸€æ¬¡æ„å»ºç”Ÿæˆçš„æ–‡ä»¶ï¼ˆæ¸…ç©º<code>.nuxt/dist/client</code> å’Œ <code>.nuxt/dist/server</code> æ–‡ä»¶å¤¹ï¼‰ï¼Œè€Œæ„å»ºå®Œæˆä¹‹åæ‰ä¼šç”Ÿæˆæ–°çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå¦‚æœç”¨æˆ·æ°å¥½åœ¨è¿™ä¸ªç©ºæ¡£æœŸè®¿é—®ç½‘ç«™æ€ä¹ˆåŠï¼Ÿä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å¹²é¢„ <code>webpack</code> çš„è¿™ç§è¡Œä¸ºï¼Œä¸å»æ¸…ç©ºè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸è¿‡æˆ‘ç›®å‰æ²¡æœ‰æ‰¾åˆ° <code>Nuxt</code> ä¸­å¯ä»¥ä¿®æ”¹è¿™ä¸ªé…ç½®çš„åœ°æ–¹ï¼ˆæ¬¢è¿è¯„è®ºï¼‰ï¼Œå¦ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨é¡¹ç›®é‡æ–°æ„å»ºçš„æ—¶å€™ï¼Œç»™ç”¨æˆ·è¿”å›ä¸€ä¸ªå‹å¥½çš„æç¤ºé¡µï¼Œå‘Šè¯‰ä»–ç³»ç»Ÿæ­£åœ¨å‡çº§ä¸­ã€‚è¿™ä¹Ÿæ˜¯æˆ‘è®¾ç½® <code>upgrading</code> å˜é‡æ¥æ ‡è®°åº”ç”¨æ˜¯å¦æ­£åœ¨å‡çº§ä¸­çš„æ„ä¹‰æ‰€åœ¨ï¼Œä¸‹é¢è¿™æ®µä»£ç å°†å±•ç¤ºï¼Œå¦‚æœå®ç°è¿™ç§æ•ˆæœï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ‹¦æˆªæ‰€ä»¥ get è¯·æ±‚ï¼Œå¦‚æœç³»ç»Ÿæ­£åœ¨å‡çº§ä¸­ï¼Œåˆ™è¿”å›æç¤ºé¡µé¢</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>upgrading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">&quot;./upgrading.html&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> root<span class="token punctuation">:</span> __dirname <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯ï¼š<code>app.get('*', ...)</code> å¿…é¡»å†™åœ¨å‰é¢ï¼Œä½ å¯ä»¥åœ¨<a href="https://expressjs.com/en/4x/api.html#app.use" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„ <code>Description</code> ä¸­æ‰¾åˆ°è§£é‡Šã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå½“ç”¨æˆ·æ°å¥½åœ¨åº”ç”¨é‡æ–°æ„å»ºæ—¶è®¿é—®ç½‘ç«™ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªå‹å¥½çš„æç¤ºé¡µï¼Œè€Œå½“æ„å»ºå®Œæˆåï¼Œç”¨æˆ·å†æ¬¡è®¿é—®ç½‘ç«™ï¼Œå°±æ˜¯ä¸€ä¸ªå‡çº§åçš„åº”ç”¨ï¼Œæ•´ä¸ªè¿‡ç¨‹ï¼ŒæœåŠ¡å™¨å§‹ç»ˆæ˜¯ä¿æŒåœ¨çº¿çš„çŠ¶æ€ï¼Œ<code>http server</code> å¹¶æ²¡æœ‰åœæ­¢æˆ–è€…é‡å¯ã€‚</p> <p>è‡³æ­¤ï¼Œä½ å·²ç»å¯ä»¥æŠŠé¡¹ç›®ä»£ç ä¸Šä¼ åˆ° <code>GitHub</code> æˆ–è€… <strong>ç äº‘</strong>äº†ï¼ˆä¸åŒçš„æœåŠ¡å•†å¯¹ <code>Webhooks</code> çš„é‰´æƒæ–¹å¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œä½ éœ€è¦å‚è€ƒä»–ä»¬çš„æ–‡æ¡£å¯¹æ¥å£çš„é‰´æƒæ–¹å¼è¿›è¡Œä¸€ç‚¹è°ƒæ•´ï¼‰ã€‚</p> <h2 id="äº”ã€éƒ¨ç½²å…¬é’¥ç®¡ç†"><a href="#äº”ã€éƒ¨ç½²å…¬é’¥ç®¡ç†" class="header-anchor">#</a> äº”ã€éƒ¨ç½²å…¬é’¥ç®¡ç†</h2> <p>ä¸ºç§æœ‰é¡¹ç›®æ·»åŠ éƒ¨ç½²å…¬é’¥ï¼Œä½¿å¾—é¡¹ç›®åœ¨æœåŠ¡å™¨ä¸Šæˆ–è€…åœ¨ <code>Docker</code> ä¸­å¯ä»¥å®‰å…¨çš„è¿›è¡Œä»£ç å…‹éš†å’Œåç»­çš„æ‹‰å–æ›´æ–°ï¼Œ<a href="https://gitee.com/help/articles/4181#article-header0" target="_blank" rel="noopener noreferrer">å‚è€ƒé“¾æ¥ 1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€<a href="https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/#generating-a-new-ssh-key" target="_blank" rel="noopener noreferrer">å‚è€ƒé“¾æ¥ 2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚è¿™é‡Œä»¥ <code>GitHub</code> ä¸ºä¾‹è¿›è¡Œä»‹ç»ï¼š</p> <ol><li><p>ç”Ÿæˆä¸€ä¸ª <code>GitHub</code> ç”¨çš„ <code>SSH key</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>ssh-keygen -t rsa -C <span class="token string">'yourEmail'</span> -f ~/.ssh/github_id_rsa
</code></pre></div><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ˜¯ä¸éœ€è¦ä½¿ç”¨ <code>-f ~/.ssh/github_id_rsa</code> æ¥æŒ‡å®šç”Ÿæˆ <code>SSH Key</code> çš„æ–‡ä»¶åçš„ï¼Œé»˜è®¤ç”Ÿæˆçš„æ˜¯ <code>id_rsa</code>ã€‚ä½†è€ƒè™‘åˆ°ä¸€å°æœºå™¨åŒæ—¶ä½¿ç”¨ä¸åŒçš„ <code>git</code> æœåŠ¡å™¨çš„å¯èƒ½æ€§ï¼Œæ‰€ä»¥è¿™é‡Œå¯¹ç”Ÿæˆçš„ <code>SSH key</code> åç§°è¿›è¡Œäº†è‡ªå®šä¹‰ã€‚è¿™é‡Œçš„é‚®ç®±æ˜¯ä½ çš„ <code>git</code> æœåŠ¡å™¨ ï¼ˆ<code>GitHub</code>ï¼‰ç™»å½•é‚®ç®±ã€‚</p></li> <li><p>åœ¨ <code>~/.ssh</code> ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª config æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œ<a href="https://www.ssh.com/ssh/config/" target="_blank" rel="noopener noreferrer">å‚è€ƒæ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># github</span>
Host github.com
HostName github.com
StrictHostKeyChecking no
PreferredAuthentications publickey
IdentityFile ~/.ssh/github_id_rsa
</code></pre></div><p>å…¶ä¸­ <code>Host</code> å’Œ <code>HostName</code> å¡«å†™ <code>git</code> æœåŠ¡å™¨çš„åŸŸåï¼Œ<code>IdentityFile</code> æŒ‡å®šç§é’¥çš„è·¯å¾„ï¼Œ<code>StrictHostKeyChecking</code> è®¾ç½®ä¸º <code>no</code> å¯ä»¥è·³è¿‡ä¸‹å›¾ä¸­ <code>(yes/no)</code> çš„è¯¢é—®ï¼Œè¿™ä¸€ç‚¹å¯¹äº <code>Docker</code> æµç•…çš„åˆ›å»ºé•œåƒå¾ˆæœ‰å¿…è¦ï¼ˆå¦åˆ™å¯èƒ½è¦å†™ <code>expect</code> è„šæœ¬ï¼‰ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡æ‰§è¡Œ <code>ssh-keyscan github.com &gt; ~/.ssh/known_hosts</code> å°† <code>host keys</code> æå‰æ·»åŠ åˆ° <code>known_hosts</code> æ–‡ä»¶ä¸­ã€‚</p></li> <li><p>åœ¨é¡¹ç›®ä»“åº“æ·»åŠ éƒ¨ç½²å…¬é’¥</p></li></ol> <ol start="4"><li><p>æµ‹è¯•å…¬é’¥æ˜¯å¦å¯ç”¨</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> -T git@github.com
</code></pre></div></li></ol> <h2 id="å…­ã€docker-éƒ¨ç½²"><a href="#å…­ã€docker-éƒ¨ç½²" class="header-anchor">#</a> å…­ã€Docker éƒ¨ç½²</h2> <h4 id="_1-å®‰è£…-docker-ce-é˜¿é‡Œäº‘-ubuntu-18-04-å·²äº²è¯•"><a href="#_1-å®‰è£…-docker-ce-é˜¿é‡Œäº‘-ubuntu-18-04-å·²äº²è¯•" class="header-anchor">#</a> 1. <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank" rel="noopener noreferrer">å®‰è£… Docker CE<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (é˜¿é‡Œäº‘ Ubuntu 18.04 å·²äº²è¯•)</h4> <h4 id="_2-åˆ›å»º-dockerfile"><a href="#_2-åˆ›å»º-dockerfile" class="header-anchor">#</a> 2. åˆ›å»º Dockerfile</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æ·»åŠ  node é•œåƒï¼Œ:8 æ˜¯æŒ‡å®š node çš„ç‰ˆæœ¬ï¼Œé»˜è®¤ä¼šæ‹‰å–æœ€æ–°çš„</span>
FROM node:8
<span class="token comment"># å®šä¹‰ SSH ç§é’¥å˜é‡</span>
ARG ssh_prv_key
<span class="token comment"># å®šä¹‰ SSH å…¬é’¥å˜é‡</span>
ARG ssh_pub_key
<span class="token comment"># åœ¨ /home ä¸‹åˆ›å»ºåä¸º webhooks-nuxt-demo çš„æ–‡ä»¶å¤¹</span>
RUN <span class="token function">mkdir</span> -p /home/webhooks-nuxt-demo
<span class="token comment"># ä¸º RUN, CMD ç­‰å‘½ä»¤æŒ‡å®šå·¥ä½œåŒº</span>
WORKDIR /home/webhooks-nuxt-demo
<span class="token comment"># åˆ›å»º .ssh ç›®å½•</span>
RUN <span class="token function">mkdir</span> -p /root/.ssh
<span class="token comment"># ç”Ÿæˆ github_id_rsaã€github_id_rsa.pub å’Œ config æ–‡ä»¶</span>
RUN <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$ssh_prv_key</span>&quot;</span> <span class="token operator">&gt;</span> /root/.ssh/github_id_rsa <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$ssh_pub_key</span>&quot;</span> <span class="token operator">&gt;</span> /root/.ssh/github_id_rsa.pub <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Host github.com<span class="token entity" title="\n">\n</span>HostName github.com<span class="token entity" title="\n">\n</span>StrictHostKeyChecking no<span class="token entity" title="\n">\n</span>PreferredAuthentications publickey<span class="token entity" title="\n">\n</span>IdentityFile /root/.ssh/github_id_rsa&quot;</span> <span class="token operator">&gt;</span> /root/.ssh/config
<span class="token comment"># ä¿®æ”¹ç§é’¥çš„ç”¨æˆ·æƒé™</span>
RUN <span class="token function">chmod</span> <span class="token number">600</span> /root/.ssh/github_id_rsa
<span class="token comment"># å…‹éš†è¿œç«¯ git ä»“åº“ä»£ç åˆ°å·¥ä½œåŒºï¼Œæ³¨æ„æœ€åçš„ . ä¸èƒ½çœç•¥</span>
RUN <span class="token function">git</span> clone git@github.com:HaoChuan9421/webhooks-nuxt-demo.git <span class="token builtin class-name">.</span>
<span class="token comment"># å®‰è£…ä¾èµ–</span>
RUN <span class="token function">npm</span> <span class="token function">install</span>
<span class="token comment"># å¯¹å¤–æš´éœ² 3000 ç«¯å£</span>
EXPOSE <span class="token number">3000</span>
<span class="token comment"># å¯åŠ¨æ—¶çš„æ‰§è¡Œè„šæœ¬</span>
CMD <span class="token function">npm</span> start
</code></pre></div><h4 id="_3-åˆ›å»º-docker-image"><a href="#_3-åˆ›å»º-docker-image" class="header-anchor">#</a> 3. åˆ›å»º Docker Image</h4> <p>é€šè¿‡ <code>cat</code> å‘½ä»¤è¯»å–ä¹‹å‰åˆ›å»ºçš„ <code>SSH</code> å…¬é’¥å’Œç§é’¥çš„å†…å®¹å¹¶ä½œä¸ºå˜é‡ä¼ é€’ç»™ <code>Docker</code>ã€‚ç”±äº <code>build</code> é•œåƒçš„è¿‡ç¨‹éœ€è¦æ‰§è¡Œ <code>git clone</code> å’Œ <code>npm install</code>ï¼Œå–å†³äºæœºå™¨æ€§èƒ½å’Œå¸¦å®½ï¼Œå¯èƒ½éœ€è¦èŠ±è´¹ä¸€å®šçš„æ—¶é—´ã€‚ä¸€ä¸ªæ­£å¸¸çš„ <code>build</code> è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker build <span class="token punctuation">\</span>
-t webhooks-nuxt-demo <span class="token punctuation">\</span>
--build-arg <span class="token assign-left variable">ssh_prv_key</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> ~/.ssh/github_id_rsa<span class="token variable">)</span></span>&quot;</span> <span class="token punctuation">\</span>
--build-arg <span class="token assign-left variable">ssh_pub_key</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> ~/.ssh/github_id_rsa.pub<span class="token variable">)</span></span>&quot;</span> <span class="token punctuation">\</span>
<span class="token builtin class-name">.</span>
</code></pre></div><img src="https://github.com/HaoChuan9421/webhooks-nuxt-demo/blob/master/assets/build-image.png" style="width:200px;"> <h4 id="_4-å¯åŠ¨å®¹å™¨"><a href="#_4-å¯åŠ¨å®¹å™¨" class="header-anchor">#</a> 4. å¯åŠ¨å®¹å™¨</h4> <p>åœ¨åå°å¯åŠ¨å®¹å™¨ï¼Œå¹¶æŠŠå®¹å™¨å†…çš„ 3000 ç«¯å£ å‘å¸ƒåˆ°ä¸»æœºçš„ 80 ç«¯å£ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> docker run -d -p <span class="token number">80</span>:3000 webhooks-nuxt-demo
</code></pre></div><h4 id="_5-è¿›å…¥æ‰§è¡Œä¸­çš„å®¹å™¨"><a href="#_5-è¿›å…¥æ‰§è¡Œä¸­çš„å®¹å™¨" class="header-anchor">#</a> 5. è¿›å…¥æ‰§è¡Œä¸­çš„å®¹å™¨</h4> <p>å¿…è¦çš„æ—¶å€™å¯ä»¥è¿›å…¥å®¹å™¨ä¸­æ‰§è¡Œä¸€äº›æ“ä½œï¼š</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># åˆ—å‡ºæ‰€æœ‰å®¹å™¨</span>
docker container <span class="token function">ls</span> -a
<span class="token comment"># è¿›å…¥æŒ‡å®šçš„å®¹å™¨ä¸­</span>
docker <span class="token builtin class-name">exec</span> -i -t å®¹å™¨åç§°æˆ–è€…å®¹å™¨ID <span class="token function">bash</span>
</code></pre></div><h2 id="ä¸ƒã€ç•™ä¸ªåé—¨"><a href="#ä¸ƒã€ç•™ä¸ªåé—¨" class="header-anchor">#</a> ä¸ƒã€ç•™ä¸ªåé—¨</h2> <p>æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦æ‰§è¡Œä¸€äº›å‘½ä»¤ï¼Œæ¥å¯¹é¡¹ç›®è¿›è¡Œæ›´ä½³çµæ´»çš„æ“ä½œï¼Œæ¯”å¦‚åˆ‡æ¢é¡¹ç›®çš„åˆ†æ”¯ã€è¿›è¡Œç‰ˆæœ¬å›æ»šç­‰ã€‚ä½†å¦‚æœåªæ˜¯ä¸ºäº†æ‰§è¡Œä¸€è¡Œå‘½ä»¤å°±éœ€è¦è¿æ¥æœåŠ¡å™¨ï¼Œå†è¿›å…¥å®¹å™¨å†…ï¼Œéš¾å…æœ‰äº›ç¹çï¼Œå¯å‘äº <code>Webhooks</code>ï¼Œæˆ‘ä»¬ä¸å¦¨ç•™ä¸ªåé—¨ ğŸ‘»ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// é¢„ç•™ä¸€ä¸ªæ¥å£ï¼Œå¿…è¦æ—¶å¯ä»¥é€šè¿‡è°ƒå–è¿™ä¸ªæ¥å£ï¼Œæ¥æ‰§è¡Œå‘½ä»¤ã€‚</span>
<span class="token comment">// å¦‚ï¼šé€šè¿‡å‘èµ·ä¸‹é¢è¿™ä¸ª AJAX è¯·æ±‚ï¼Œæ¥è¿›è¡Œ npm åŒ…çš„å‡çº§å¹¶é‡æ–°æ„å»ºé¡¹ç›®ã€‚</span>
<span class="token comment">// var xhr = new XMLHttpRequest();</span>
<span class="token comment">// xhr.open('post', '/command');</span>
<span class="token comment">// xhr.setRequestHeader('access_token', 'b65c19b95906e027c5d8');</span>
<span class="token comment">// xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');</span>
<span class="token comment">// xhr.send(</span>
<span class="token comment">//   JSON.stringify({</span>
<span class="token comment">//     command: 'npm update',</span>
<span class="token comment">//     reBuild: true</span>
<span class="token comment">//   })</span>
<span class="token comment">// );</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/command&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¦‚æœå¿…è¦çš„è¯å¯ä»¥è¿›è¡Œæ›´ä¸¥æ ¼çš„é‰´æƒï¼Œè¿™é‡Œåªæ˜¯ä¸€ä¸ªç¤ºèŒƒ</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;access_token&quot;</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;b65c19b95906e027c5d8&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶è¿”å›å‘½ä»¤çš„æ‰§è¡Œç»“æœ</span>
    <span class="token function">execCommand</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>command<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>reBuild<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>
      <span class="token parameter">error<span class="token punctuation">,</span>
      stdout<span class="token punctuation">,</span>
      stderr</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> stdout<span class="token punctuation">,</span> stderr <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¦‚æœæ˜¯çº¯ç²¹çš„é‡æ–°æ„å»ºï¼Œæ²¡æœ‰éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œç›´æ¥ç»“æŸè¯·æ±‚ï¼Œä¸éœ€è¦ç­‰å¾…å‘½ä»¤çš„æ‰§è¡Œç»“æœ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>command <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>reBuild<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;Authorized and rebuilding!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;Permission Denied&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/20/2019, 11:03:41 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/myblog/FrontEnd/" class="prev router-link-active">ä»‹ç»</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/myblog/assets/js/app.8fae4f1c.js" defer></script><script src="/myblog/assets/js/2.b3a321be.js" defer></script><script src="/myblog/assets/js/8.00ec649f.js" defer></script>
  </body>
</html>
