# åšå®¢è¿›é˜¶

## [ä¾§è¾¹æ ](https://vuepress.vuejs.org/zh/theme/default-theme-config.html#%E4%BE%A7%E8%BE%B9%E6%A0%8F)æ‰‹åŠ¨é…ç½®

æƒ³è¦ä½¿ ä¾§è¾¹æ ï¼ˆSidebarï¼‰ç”Ÿæ•ˆï¼Œéœ€è¦é…ç½® <code>themeConfig.sidebar</code>ï¼ŒåŸºæœ¬çš„é…ç½®ï¼Œéœ€è¦ä¸€ä¸ªåŒ…å«äº†å¤šä¸ªé“¾æ¥çš„æ•°ç»„ï¼š

```js
// .vuepress/config.js
module.exports = {
  themeConfig: {
    sidebar: ["/", "/page-a", ["/page-b", "Explicit link text"]]
  }
};
```

ä½ å¯ä»¥çœç•¥ <code>.md </code>æ‹“å±•åï¼ŒåŒæ—¶ä»¥ / ç»“å°¾çš„è·¯å¾„å°†ä¼šè¢«è§†ä¸º<code> \*/README.md</code>ï¼Œè¿™ä¸ªé“¾æ¥çš„æ–‡å­—å°†ä¼šè¢«è‡ªåŠ¨è·å–åˆ°ï¼ˆæ— è®ºä½ æ˜¯å£°æ˜ä¸ºé¡µé¢çš„ç¬¬ä¸€ä¸ª headerï¼Œè¿˜æ˜¯æ˜ç¡®åœ°åœ¨ <code>YAML front matter</code> ä¸­æŒ‡å®šé¡µé¢çš„æ ‡é¢˜ï¼‰ã€‚å¦‚æœä½ æƒ³è¦æ˜¾ç¤ºåœ°æŒ‡å®šé“¾æ¥çš„æ–‡å­—ï¼Œä½¿ç”¨ä¸€ä¸ªæ ¼å¼ä¸º<code>[link, text]</code> çš„æ•°ç»„

## sidebarï¼šåŠ¨æ€é…ç½®

- å¿«æ·é…ç½®ä¾§è¾¹æ 
- è§£å†³æ‰‹åŠ¨æ›´æ”¹ <code>sidebar</code> å¸¦æ¥çš„çƒ¦æ¼
- [code](https://github.com/Guanyuhao/myblog)

### åˆ›å»ºå¥½ç›®å½•ç»“æ„

```
myblog
â”œâ”€â”€â”€ config
|   â””â”€â”€â”€  sidebar.js
â”œâ”€â”€â”€ utils
|   â”œâ”€â”€ getFilenames.js
â”‚   â””â”€â”€ index.js
â”œâ”€â”€â”€ docs
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ algorithm
|   |   â””â”€â”€â”€ README.md
â”‚   â”œâ”€â”€ guide
|   |   â”œâ”€â”€â”€ text.md
|   |   â””â”€â”€â”€ README.md
â”‚   â””â”€â”€ .vuepress
â”‚       â”œâ”€â”€ styles
|       |   â””â”€â”€â”€ index.styl
â”‚       â”œâ”€â”€ public
|       |   â””â”€â”€â”€ yuhao.jpg
â”‚       â””â”€â”€ config.js
â””â”€â”€ package.json
```

### utils ç›®å½•

- ä¸º<code>confg</code>æ–‡ä»¶å¤¹æä¾›æ‰€éœ€çš„å·¥å…·ç±»ã€‚

**è·å– docs æ–‡ä»¶ç›®å½•åå­—**

```js
const fs = require("fs");
const path = require("path");
const rootpath = path.dirname(__dirname);
const docs = rootpath + "/docs/";

var file = {
  isDir(path) {
    return this.exists(path) && fs.statSync(path).isDirectory();
  },
  exists(path) {
    return fs.existsSync(path) || path.existsSync(path);
  },
  getFileDirectory(rpath) {
    let fileDirectoryName = [];
    fs.readdirSync(rpath).forEach(file => {
      let fullpath = rpath + "/" + file;
      if (excludes.indexOf(file) < 0 && this.isDir(fullpath)) {
        fileDirectoryName.push(file);
      }
    });
    fileDirectoryName.sort(); // æ’åº
    return fileDirectoryName;
  }
};
file.getFileDirectory(docs);
// ['algorithm','guide']
```

**è·å– docs ç›®å½•ä¸‹.md åç¼€çš„æ–‡ä»¶**

```js
const fs = require("fs");
const path = require("path");
const rootpath = path.dirname(__dirname);
const docs = rootpath + "/docs/";

var file = {
  isDir(path) {
    return this.exists(path) && fs.statSync(path).isDirectory();
  },
  exists(path) {
    return fs.existsSync(path) || path.existsSync(path);
  },
  getFileDirectory(rpath) {
    let fileDirectoryName = [];
    fs.readdirSync(rpath).forEach(file => {
      let fullpath = rpath + "/" + file;
      if (excludes.indexOf(file) < 0 && this.isDir(fullpath)) {
        fileDirectoryName.push(file);
      }
    });
    fileDirectoryName.sort();
    return fileDirectoryName;
  },
  getFileName(rpath) {
    let filenames = [];
    fs.readdirSync(rpath).forEach(file => {
      if (excludes.indexOf(file) < 0) {
        let fullpath = rpath + "/" + file;
        let fileinfo = fs.statSync(fullpath);
        if (fileinfo.isFile()) {
          if (file === "README.md") {
            file = "";
          } else {
            file = file.replace(".md", "");
          }
          filenames.push(file);
        }
      }
    });
    // console.log(filenames)
    filenames.sort();
    return filenames;
  }
};
file.getFileName(docs + "guide/");
// result
// ["", "test"];
```

## config ç›®å½•

- åŠ¨æ€ç”Ÿæˆæ‰€éœ€è¦çš„é…ç½®å¯¹è±¡ï¼Œä¸º<code>public/config.js</code>ä½¿ç”¨ã€‚
- ç›®å‰åªæœ‰ sidebar,ä¹Ÿè®¸ä»¥åä¼šå¢åŠ  nav.js ...

### config/sidebar.js

```js
const path = require("path");
const rootpath = path.dirname(__dirname);
const docs = rootpath + "/docs/";
const { genSidebar } = require(rootpath + "/utils/index.js");
const filehelper = require(rootpath + "/utils/getFilenames.js");

function generateObj(cnDocNameArr) {
  let obj = {};
  let docDirArr = filehelper.getFileDirectory(docs);
  docDirArr.forEach((element, index) => {
    let val = cnDocNameArr[index];
    obj[`/${element}/`] = genSidebar(
      val,
      filehelper.getFileName(`${docs}${element}/`),
      false
    );
  });
  return obj;
}

module.exports = {
  sidebar: generateObj(["ç®—æ³•", "æŒ‡å—"])
};
```

### utils/getFilenames.js

```js
/**
 * æ–‡ä»¶åå­—çš„è·å–
 */
const fs = require("fs");
// æ’é™¤æ£€æŸ¥çš„æ–‡ä»¶
const excludes = [".vuepress"];

class filehelper {
  constructor() {}
  getFileName(rpath) {
    let filenames = [];
    fs.readdirSync(rpath).forEach(file => {
      if (excludes.indexOf(file) < 0) {
        let fullpath = rpath + "/" + file;
        let fileinfo = fs.statSync(fullpath);
        if (fileinfo.isFile()) {
          if (file === "README.md") {
            file = "";
          } else {
            file = file.replace(".md", "");
          }
          filenames.push(file);
        }
      }
    });
    filenames.sort();
    return filenames;
  }
  getFileDirectory(rpath) {
    let fileDirectoryName = [];
    fs.readdirSync(rpath).forEach(file => {
      let fullpath = rpath + "/" + file;
      if (excludes.indexOf(file) < 0 && this.isDir(fullpath)) {
        fileDirectoryName.push(file);
      }
    });
    fileDirectoryName.sort(); // æ’åº
    return fileDirectoryName;
  }
  exists(path) {
    return fs.existsSync(path) || path.existsSync(path);
  }
  isDir(path) {
    return this.exists(path) && fs.statSync(path).isDirectory();
  }
}

module.exports = new filehelper();
```

### utils/index.js

```js
const utils = {
  genSidebar(title, children = [""], collapsable = true, sidebarDepth = 2) {
    var arr = new Array();
    arr.push({
      title,
      collapsable,
      sidebarDepth,
      children
    });
    return arr;
  }
};

module.exports = utils;
```

### docs/.vuepress/config.js

```js
const { sidebar } = require("../../config/sidebar");
module.exports = {
  // å…¶ä»–é…ç½®
  themeConfig: {
    sidebar
  }
};
```

## GitHub Pages and Travis CI

1. åœ¨ `docs/.vuepress/config.js` ä¸­è®¾ç½®æ­£ç¡®çš„ `base`ã€‚
2. é¡¹ç›®çš„æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸º `.travis.yml` çš„æ–‡ä»¶ï¼›
3. æœ¬åœ°æ‰§è¡Œ npm install å¹¶ä¸”åœ¨æäº¤ä¸­åŒ…å« package-lock.json å› ä¸º npm ci éœ€è¦å®ƒæ‰èƒ½æ­£ç¡®æ‰§è¡Œã€‚ï¼ï¼ï¼ğŸ–
4. ä½¿ç”¨ GitHub Pages éƒ¨ç½²æä¾›ç¨‹åºæ¨¡æ¿å¹¶éµå¾ª [Travis æ–‡æ¡£](https://docs.travis-ci.com/user/deployment/pages/)

```yaml
language: node_js
node_js:
  - lts/*
install:
  - npm ci
script:
  - npm install -g vuepress
  - npm run docs:build
    # - cd docs/.vuepress/dist/
deploy:
  provider: pages
  skip_cleanup: true
  local_dir: docs/.vuepress/dist/
  token: $GITHUB_TOKEN # a token generated on github allowing travis to push code on you repository
  keep_history: true
  on:
    branch: master
```

### Created GITHUB_TOKEN

![githubSetting](/guideImg/githubSetting.jpg)

![DeveloperSetting](/guideImg/DeveloperSetting.jpg)

![createdToken](/guideImg/createdToken.jpg)

æƒé™é€‰æ‹©é™¤äº† `delete_repo` å…¨ âœ”

### Travis CI

Travis CI æ˜¯åœ¨çº¿æ‰˜ç®¡çš„ CI æœåŠ¡ï¼Œç”¨ Travis æ¥è¿›è¡ŒæŒç»­é›†æˆï¼Œä¸éœ€è¦è‡ªå·±æ­æœåŠ¡å™¨ï¼Œåœ¨ç½‘é¡µä¸Šç‚¹å‡ ä¸‹å°±å¥½ï¼Œç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒå¯¹å¼€æºé¡¹ç›®æ˜¯å…è´¹çš„ã€‚

1. `github` æˆæƒç™»å½• `Travis`, è¿›å…¥ `Setting`
2. å¼€å¯`Travis CI` å¯¹ `github` éœ€è¦ CI çš„æƒé™
3. `Setting` å½“å‰ä»“åº“çš„æ‰€éœ€è¦çš„ç¯å¢ƒå˜é‡æ¯”å¦‚`GITHUB_TOKEN`

![Travis CI](/guideImg/travis.jpg)

æ¨é€ä½ çš„ä»£ç åˆ°çš„ä½ è‡ªå·±çš„ä»“åº“,æ‰“å¼€`Travis`äº§çœ‹ job log
